<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุนุฑุถ ุชูุงุฑูุฑ ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุฏุฑูุณ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f9fafb;
        }
        .page-container {
            max-width: 1000px;
            margin: 2rem auto;
            background-color: white;
            border: 1px solid #d1d5db;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            overflow: hidden;
            transition: max-width 0.3s ease;
        }
        .form-title {
            background-color: #006b5a;
            color: white;
            padding: 0.75rem;
            text-align: center;
            font-size: 1.25rem;
            font-weight: bold;
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr 2fr);
        }
        .form-label-cell,
        .form-data-cell {
            padding: 0.5rem 0.75rem;
            border: 1px solid #d1d5db;
            display: flex;
            align-items: center;
            min-height: 50px;
            word-break: break-word;
        }
        .form-label-cell {
            background-color: #f3f4f6;
            font-weight: 500;
            color: #1f2937;
        }
        .label-span-1 { grid-column: span 1; }
        .data-span-3 { grid-column: span 3; }
        .printable-offscreen {
            position: absolute;
            left: -9999px;
            width: 842px;
        }
        .evidence-image-container {
            width: 100%;
            height: 250px;
            overflow: hidden;
            border-radius: 0.375rem;
            border: 1px solid #d1d5db;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f9fafb;
        }
        .evidence-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        @media print {
            body.printing > :not(#report-display-wrapper),
            body.printing .no-print { display: none !important; }
            @page { size: A4; margin: 0; }
            body.printing {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                background-color: white;
                margin: 0; padding: 0;
            }
            body.printing #report-display-wrapper { margin: 0; padding: 0; }
            body.printing #report-display.page-container {
                max-width: none !important;
                margin: 0 !important;
                padding: 0 !important;
                border: none !important;
                box-shadow: none !important;
                font-size: 9pt;
            }
            body.printing .printable-content {
                padding: 1.5rem !important; /* ุงูุงุญุชูุงุธ ุจูุงูุด ููุตูุญุฉ */
            }
             body.printing .form-label-cell, body.printing .form-data-cell {
                padding: 0.3rem 0.5rem; min-height: 40px;
            }
            body.printing header, body.printing footer { padding: 0.5rem; }
            body.printing h1.form-title { padding: 0.5rem; margin: 0.5rem 0; }
            body.printing .print-bg-green { background-color: #006b5a !important; }
        }
    </style>
</head>
<body class="bg-gray-50">

    <div class="page-container no-print">
        <div class="p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">ุชูุงุฑูุฑ ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุฏุฑูุณ</h2>
                <button onclick="printReportsList()" id="print-list-btn" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg transition-colors flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v6a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z" clip-rule="evenodd" /></svg>
                    ุทุจุงุนุฉ ุงููุงุฆูุฉ
                </button>
            </div>
             <div id="reports-list" class="space-y-1">
                <p class="text-gray-500 text-center p-4">ุฌุงุฑู ุชุญููู ุงูุชูุงุฑูุฑ...</p>
            </div>
        </div>
    </div>
    
    <div id="report-display-wrapper">
         <div id="report-display" class="hidden page-container">
            </div>
    </div>
    
    <div id="report-actions" class="hidden max-w-4xl mx-auto p-4 text-center no-print bg-white flex justify-center items-center gap-4" style="margin-top: -2rem; position: relative; z-index: 10; border-radius: 0 0 0.5rem 0.5rem; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);">
        <button onclick="downloadPdf()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg transition-colors">ุชุญููู PDF</button>
    </div>


    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, query, onSnapshot, orderBy, doc, deleteDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        const { jsPDF } = window.jspdf;

        // *** ุถุน ููุณ ุฅุนุฏุงุฏุงุช Firebase ุงูุฎุงุตุฉ ุจู ููุง ***
        const firebaseConfig = {
          apiKey: "AIzaSyBMDIL5dPISS4pRimDfN_22NMd1l0QNsCA",
          authDomain: "reports-e0260.firebaseapp.com",
          projectId: "reports-e0260",
          storageBucket: "reports-e0260.firebasestorage.app",
          messagingSenderId: "879236632191",
          appId: "1:879236632191:web:da49b42e6af93ea1d6794a"
        };

        const appId = firebaseConfig.projectId;
        
        let app, db, auth;
        let currentReportData = null;
        let allReportsData = [];
       
        try {
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
        } catch (error) {
            console.error("Firebase Initialization Error:", error);
        }

        onAuthStateChanged(auth, (user) => {
            if (user) {
                listenForReports();
            } else {
                 signInAnonymously(auth).catch(err => {
                    console.error("Anonymous sign-in failed:", err);
                 });
            }
        });

        const reportsList = document.getElementById('reports-list');
        const reportDisplay = document.getElementById('report-display');
        const reportActions = document.getElementById('report-actions');
        
        function listenForReports() {
            const reportsRef = collection(db, `/artifacts/${appId}/public/data/strategies`);
            const q = query(reportsRef, orderBy('createdAt', 'desc'));

            onSnapshot(q, (querySnapshot) => {
                allReportsData = []; 
                if (querySnapshot.empty) {
                    reportsList.innerHTML = '<p class="text-gray-500 text-center p-4">ูุง ุชูุฌุฏ ุชูุงุฑูุฑ ุงุณุชุฑุงุชูุฌูุงุช ูุญููุธุฉ ุญุชู ุงูุขู.</p>';
                    return;
                }

                reportsList.innerHTML = `
                    <div class="grid grid-cols-12 gap-2 font-bold text-sm text-gray-600 px-3 py-2 border-b">
                        <div class="col-span-3">ุงุณู ุงููุนูู</div>
                        <div class="col-span-3">ุงูุงุณุชุฑุงุชูุฌูุฉ</div>
                        <div class="col-span-2">ุงููุงุฏุฉ</div>
                        <div class="col-span-2">ุชุงุฑูุฎ ุงูุชูููุฐ</div>
                        <div class="col-span-2 text-center">ุฅุฌุฑุงุกุงุช</div>
                    </div>
                `; 
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    allReportsData.push(data); 
                    const docId = doc.id;
                    
                    const teacherName = data.teacherName || 'ูุนูู ุบูุฑ ูุณุฌู';
                    const strategyName = data.strategyName || 'ุงุณุชุฑุงุชูุฌูุฉ ุบูุฑ ูุณุฌูุฉ';
                    const subject = data.subject || 'N/A';
                    const executionDate = data.executionDate || 'N/A';

                    const listItem = document.createElement('div');
                    listItem.className = 'grid grid-cols-12 gap-2 items-center text-sm p-3 border-b hover:bg-gray-100 cursor-pointer';
                    
                    listItem.innerHTML = `
                        <div class="col-span-3 font-semibold text-blue-700 truncate" onclick="window.displayReportById('${docId}')">${teacherName}</div>
                        <div class="col-span-3 text-gray-700 truncate" onclick="window.displayReportById('${docId}')">${strategyName}</div>
                        <div class="col-span-2 text-gray-500" onclick="window.displayReportById('${docId}')">${subject}</div>
                        <div class="col-span-2 text-gray-500" onclick="window.displayReportById('${docId}')">${executionDate}</div>
                        <div class="col-span-2 text-center flex justify-center gap-3">
                             <a href="./index.html?edit=${docId}" target="_blank" class="text-blue-600 hover:text-blue-800" title="ุชุนุฏูู ุงูุชูุฑูุฑ">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                            </a>
                            <button onclick="window.deleteReport(event, '${docId}')" class="text-red-600 hover:text-red-800" title="ุญุฐู ุงูุชูุฑูุฑ">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                            </button>
                        </div>
                    `;
                    reportsList.appendChild(listItem);
                });

            }, (error) => {
                console.error("Error fetching reports in real-time:", error);
                reportsList.innerHTML = '<p class="text-red-500 text-center p-4">ุญุฏุซ ุฎุทุฃ ูู ุชุญููู ูุงุฆูุฉ ุงูุชูุงุฑูุฑ.</p>';
            });
        }
        
        window.printReportsList = async function() {
            // (Code for printing list remains unchanged)
        }
        
        window.deleteReport = async function(event, docId) {
            // (Code for deleting remains unchanged)
        }
        
        window.downloadPdf = async function() {
            const reportContent = document.querySelector("#report-display .printable-content");
            const reportContainer = document.getElementById('report-display');
            if (!reportContent || !currentReportData) {
                alert("ูุฑุฌู ุนุฑุถ ุชูุฑูุฑ ุฃููุงู.");
                return;
            }

            const programName = currentReportData.strategyName || 'ุงุณุชุฑุงุชูุฌูุฉ';
            const teacherName = currentReportData.teacherName || 'ูุนูู';
            const filename = `${programName} - ${teacherName}.pdf`;

            const originalMaxWidth = reportContainer.style.maxWidth;
            const originalMargin = reportContainer.style.margin;
            reportContainer.style.maxWidth = 'none';
            reportContainer.style.margin = '0';

            try {
                const canvas = await html2canvas(reportContent, { 
                    scale: 2, 
                    useCORS: true // ูุฐุง ุณูุนูู ุงูุขู ูุฃู ูู ุงูุตูุฑ ูุฏูุฌุฉ
                });
                
                const imgData = canvas.toDataURL('image/png');
                
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'pt',
                    format: 'a4'
                });

                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = pdf.internal.pageSize.getHeight();
                const imgProps = pdf.getImageProperties(imgData);
                const imgWidth = imgProps.width;
                const imgHeight = imgProps.height;
                
                const ratio = pdfWidth / imgWidth;
                const calculatedHeight = imgHeight * ratio;
                let pageHeight = pdfHeight;
                let position = 0;

                pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, calculatedHeight);
                let heightLeft = calculatedHeight - pageHeight;

                while (heightLeft > 0) {
                    position = position - pdfHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, pdfWidth, calculatedHeight);
                    heightLeft -= pageHeight;
                }

                pdf.save(filename);
            } catch (error) {
                console.error("ุฎุทุฃ ูู ุฅูุดุงุก PDF:", error);
                alert("ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅูุดุงุก ููู PDF.");
            } finally {
                reportContainer.style.maxWidth = originalMaxWidth;
                reportContainer.style.margin = originalMargin;
            }
        }

        window.displayReportById = async (docId) => {
            const reportRef = doc(db, `/artifacts/${appId}/public/data/strategies`, docId);
            try {
                const docSnap = await getDoc(reportRef);
                if (docSnap.exists()){
                    const data = docSnap.data();
                    data.id = docId; 
                    currentReportData = data;
                    displayReportData(data);
                } else {
                    alert("ูู ูุชู ุงูุนุซูุฑ ุนูู ุงูุชูุฑูุฑ.");
                    currentReportData = null;
                }
            } catch(error) {
                 alert("ุฎุทุฃ ูู ุฌูุจ ุจูุงูุงุช ุงูุชูุฑูุฑ.");
                 console.error(error);
                 currentReportData = null;
            }
        };

        function displayReportData(data) {
            
            let aidsItems = data.teachingAids && data.teachingAids.length > 0
                ? data.teachingAids.map(aid => {
                    if (aid === "ุฃุฎุฑู" && (!data.teachingAidsOther || data.teachingAidsOther.trim() === "")) {
                        return null; 
                    }
                    if (aid === "ุฃุฎุฑู" && data.teachingAidsOther && data.teachingAidsOther.trim() !== "") {
                        return `<li class="list-disc mr-4">ุฃุฎุฑู: ${data.teachingAidsOther}</li>`;
                    }
                    return `<li class="list-disc mr-4">${aid}</li>`;
                }).filter(item => item !== null)
                : [];
            
            if (data.teachingAidsOther && data.teachingAidsOther.trim() !== "" && !data.teachingAids.includes("ุฃุฎุฑู")) {
                 aidsItems.push(`<li class="list-disc mr-4">ุฃุฎุฑู: ${data.teachingAidsOther}</li>`);
            }

            const aidsList = aidsItems.length > 0
                ? `<ul class="text-blue-800 font-semibold grid grid-cols-2 gap-1 w-full">${aidsItems.join('')}</ul>`
                : '<span class="text-blue-800 font-semibold">ูุง ููุฌุฏ</span>';

            const objectivesList = data.objectives
                ? `<ol class="text-blue-800 font-semibold list-decimal pr-5">${data.objectives.split('\n').filter(line => line.trim() !== '').map(obj => `<li class="mb-1">${obj}</li>`).join('')}</ol>`
                : '<span class="text-blue-800 font-semibold">ูุง ููุฌุฏ</span>';

            // --- ๐ด ุงูุชุนุฏูู: ุฅุถุงูุฉ ุฃููุงุฏ Base64 ููุดุนุงุฑุงุช (ุจุตูุบุฉ PNG) ---
            const ministryLogoBase64 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADRCAMAAABlY/YCAAAAbFBMVEX////AwMD8/Pz09PTT09NdXV1RUVGpqamfn59xcXHq6urc3Nzj4+NmZmaQkJBXV1e6urqioqJEREQ6OjonJycODg7t7e1wcHCSkpKkpKRoaGhvb28/Pz+rq6uHh4cMDAxZWVmCgoIODg4vLy9ViqBqAAAA90lEQVR42u3YMRaDIAwEwfMSoAhSwfb/v6Sg6WKlQycd5T7wKzPZ6LwIIYQQQgghhBBCCHkf0/GqD/t/qj6A9B9kxxXEBESKCEeEIzIBBwIJJJBAAggkkEACCSSQQAKZkM2vN5CL3i+Qy9r3kcvG95LLgvcYl+0vEsl2HkPZuJbH0DOsiQeRs2wBHkRNsmYeiJpkzU0QMsmqecCyZE3cEmyJG+GTYEfcEWZEHcFWZEXcEWZEHYFUZEHcFWZEHYFUZEHcFWZEPYEkZEHcFWZEPYEkZEHcFWZEPYEkZEHcFWZEPYEkZEHcFWZEPYEkZEHcFWZEPYEkZFEEIYQQQgghhBBCCO9v3b0BfQJjXbYAAAAASUVORK5CYII=";
            
            const visionLogoBase64 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAC+CAMAAAD8fGMcAAABAlBMVEX////tGy7tESr3vMf85ej97/L61+D62+L2uMLvOD/sABDtExz98PPvMC7xX2j63OPtGy/tECf2tcDuPy/uSDHtFBnwcHT2uL7sABj74uf4xM3wXVvuRjDsABb1Rkbwcm/sABH62N71S0vya2/whJLsABDgopT73+T5z9f0Qj3tICLybHD3vsrwhI7+9fbvOjvxZmr86ezmraz50dfxZWnzdXXzh5P61tr2tbrwhYb74+f3v8zwnqL50tX3vMPwcmjxdn3sABTwhIXsAAvfmpPYkJDycmjvhI3ya2f4yM72t7/wnJ3vf4XybG/3usDvOjrzdHXvPj/vMCYkRjGkAAAA/klEQVR42u3di1LUQBhG4cMIIuKioiLuVdG9i/teRVEUFPcE7v3/v9aBCiLGGOrpTqfv/Q7pD8mQnq6nUwohgggggggggggggggggggggggggggggggggggggggiK1iNtO/17f4qjce9aLpZk/Y/dK91pXqSypzGv6/r+v6vD53e3N4k2n1eZ6t/eC13L1tHlZPb3K/fDWu2X3u01/N3NfMv/G9nf2/bK/3N/v1dXe3t6fn9/vV1d3J29enpy/P6vj69e/vT09vT0/f6+Pz+/X6/N/G+D/fy/j/P3+fP38fr+8er65vb28ePl89fLi9ubp+eXy8vXq4g+vL19e3rx8/fr68ub29vb69evp6enp4d3t7fXp6eHx+f7x8enp8e7x/vHx/vHx6fH+/uHp6f7x/v7h/v7+8fH+8f7+4f7+/vHx4/Pz4/Pz8/Pj8+Pz4/Pz4/Pz4/Pz4/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/Pj8/PjSCAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAAEEAgABBAAACfwB4M/F9qjFEYwAAAABJRU5ErkJggg==";

            reportDisplay.innerHTML = `
                <div class="printable-content">
                    <header class="bg-[#006b5a] text-white p-4 print-bg-green">
                        <div class="max-w-4xl mx-auto flex justify-between items-center">
                            <div class="w-1/3 text-right text-xs leading-tight">
                                <p>ุงูุฅุฏุงุฑุฉ ุงูุนุงูุฉ ููุชุนููู ุจููุทูุฉ ุนุณูุฑ</p>
                                <p class="font-bold text-sm text-yellow-300">ุงุจุชุฏุงุฆูุฉ ููุชูุณุทุฉ ุงูุฑุงุดุฏูู ุจุงููุฑุจุน</p>
                            </div>
                            
                            <div class="w-1/3 text-center">
                                <img src="${ministryLogoBase64}" alt="ุดุนุงุฑ ุงููุฒุงุฑุฉ" class="h-16 mx-auto">
                            </div>
                            <div class="w-1/3 text-left">
                                <img src="${visionLogoBase64}" alt="ุดุนุงุฑ ุงูุฑุคูุฉ" class="h-16 mx-auto">
                            </div>

                        </div>
                    </header>
                    
                    <h1 class="form-title mt-4 mb-4 mx-4">ุชูุฑูุฑ ุชูููุฐ ุงุณุชุฑุงุชุฌูุฉ ุชุฏุฑูุณ</h1>
                    
                    <main class="px-4">
                        <div class="form-grid">
                            <div class="form-label-cell">ุงุณู ุงููุนูู ุงููููุฐ:</div>
                            <div class="form-data-cell"><span class="text-blue-800 font-semibold">${data.teacherName || ''}</span></div>
                            <div class="form-label-cell">ูุฏูุฑ ุงููุฏุฑุณุฉ:</div>
                            <div class="form-data-cell"><span class="text-blue-800 font-semibold">${data.principalName || ''}</span></div>

                            <div class="form-label-cell">ุงูุงุณุชุฑุงุชูุฌูุฉ:</div>
                            <div class="form-data-cell"><span class="text-blue-800 font-semibold">${data.strategyName || ''}</span></div>
                            <div class="form-label-cell">ุงููุงุฏุฉ:</div>
                            <div class="form-data-cell"><span class="text-blue-800 font-semibold">${data.subject || ''}</span></div>

                            <div class="form-label-cell">ุชุงุฑูุฎ ุงูุชูููุฐ:</div>
                            <div class="form-data-cell"><span class="text-blue-800 font-semibold">${data.executionDate || ''}</span></div>
                            <div class="form-label-cell">ุงูุฏุฑุณ:</div>
                            <div class="form-data-cell"><span class="text-blue-800 font-semibold">${data.lesson || ''}</span></div>

                            <div class="form-label-cell">ุงููุฑุญูุฉ ุงูุฏุฑุงุณูุฉ:</div>
                            <div class="form-data-cell"><span class="text-blue-800 font-semibold">${data.stage || ''}</span></div>
                            <div class="form-label-cell">ุงููุตู:</div>
                            <div class="form-data-cell"><span class="text-blue-800 font-semibold">${data.classSection || ''}</span></div>
                            
                            <div class="form-label-cell">ุนุฏุฏ ุงูุทูุงุจ:</div>
                            <div class="form-data-cell data-span-3"><span class="text-blue-800 font-semibold">${data.studentCount || ''}</span></div>

                            <div class="form-label-cell label-span-1">ุงูุฃุฏูุงุช ูุงููุณุงุฆู ุงูุชุนููููุฉ:</div>
                            <div class="form-data-cell data-span-3">${aidsList}</div>
                            
                            <div class="form-label-cell label-span-1">ุงูุฃูุฏุงู:</div>
                            <div class="form-data-cell data-span-3">${objectivesList}</div>

                            <div class="form-label-cell label-span-1">ุดูุงูุฏ ุงูุชูููุฐ:</div>
                            <div class="form-data-cell data-span-3">
                                <div class="w-full flex gap-4">
                                    <div class="w-1/2">
                                        <div class="evidence-image-container">
                                            ${data.image1 ? `<img src="${data.image1}" class="evidence-image" crossorigin="anonymous">` : '<span class="text-gray-500">ูู ูุชู ุฑูุน ุตูุฑุฉ 1</span>'}
                                        </div>
                                    </div>
                                    <div class="w-1/2">
                                        <div class="evidence-image-container">
                                            ${data.image2 ? `<img src="${data.image2}" class="evidence-image" crossorigin="anonymous">` : '<span class="text-gray-500">ูู ูุชู ุฑูุน ุตูุฑุฉ 2</span>'}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </main>

                    <footer class="flex justify-between items-center pt-8 mt-8 border-t px-4 pb-4">
                        <div class="text-center">
                             <p class="text-sm text-gray-600">ูุฏูุฑ ุงููุฏุฑุณุฉ</p>
                             <p class="font-bold text-lg">${data.principalName || 'ุงุณู ุงููุฏูุฑ'}</p>
                        </div>
                        <div class="text-center">
                            <p class="text-sm text-gray-600">ุงููุนูู ุงููููุฐ</p>
                            <p class="font-bold text-lg">${data.teacherName || 'ุงุณู ุงููุนูู'}</p>
                        </div>
                    </footer>
                </div>
            `;
            
            reportDisplay.classList.remove('hidden');
            reportActions.classList.remove('hidden');
            reportDisplay.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    </script>
</body>
</html>
